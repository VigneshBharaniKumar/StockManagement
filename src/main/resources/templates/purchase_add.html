<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Purchase</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Ubuntu', sans-serif;
            font-weight: 400;
            max-height: 90vh;
            margin: 0;
            padding:0;
        }
    </style>
    <link href="css/main.css" rel="stylesheet">
</head>
<body>

<div th:replace="fragments/nav :: navbar"></div>
    
    <div class="container-fluid d-flex justify-content-center mt-5">
    
        <div class="container-fluid shadow p-3 mb-2 bg-body rounded m-3">

            <h1 class="m-3"> Add Purchase </h1>

            <hr class="border border-secondary border-1 opacity-20">

            <div class="row">

<!--            TABLE-->
                <div class="col-lg-6">
                    <div class="col-md-auto align-self-end">
                        <div class="row">
                            <!--ADD PRODUCT-->
                            <div class="col-lg-6">
                                <a class="btn btn-primary m-3" th:href="@{/products/add}" role="button">Add Product</a>
                            </div>
                            <!--SEARCH-->
                            <div class="col-lg-6 align-self-end">
                                <div class="form-group m-3">
                                    <form class="form-inline" th:action="@{/purchase/add/search}" method="get">
                                        <div class="input-group">
                                            <input type="search" name="keyword" th:value="${keyword}" class="form-control" id="txtSearchProductName" placeholder="Search by Name">
                                            <button class="btn btn-outline-secondary border-left-0 border" type="submit">
                                                <i class="bi bi-search"></i>
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="table_row" class="row scrollable" style="max-height:70vh; overflow-y:scroll;">
                        <!--TABLE CARD-->
                        <div class="container-fluid"
                             th:data-id="${product.id}"
                             th:data-name="${product.name}"
                             th:data-category="${product.category}"
                             onclick="selectProduct(this,this.getAttribute('data-id'), this.getAttribute('data-name'), this.getAttribute('data-category'))"
                             th:each = "product : ${listProducts}">

                            <div id="table_card" class="container-fluid shadow px-3 py-1 bg-body rounded my-1">
                                <div class="row mt-1">

                                    <div class="col-4">
                                        <div>
                                            <h5>[[${product.name}]]<h6><span class="badge bg-secondary">Id: [[${product.id}]]</span></h6></h5>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <p>Category : [[${product.category}]]</p>
                                        <p>Description : [[${product.description}]]</p>
                                    </div>
                                    <div class="col-lg-3">
                                        <p>Selling Price : [[${product.selling_price}]]</p>
                                        <p>In-Stock : [[${product.in_stock}]]</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

<!--            FORM-->
                <div class="col-lg-6">
                    <form method="post" th:action="@{save}" th:object="${purchasedItem}" >

                        <div class="form-group m-3">
                            <label for="productName">Product Id</label>
                            <input type="text" class="form-control" th:field="*{productId}" id="productId" placeholder="Select Product" readonly required>
                        </div>

                        <div class="form-group m-3">
                            <label for="productName">Product Name</label>
                            <input type="text" class="form-control" th:field="*{productName}" id="productName" placeholder="Select Product" readonly>
                        </div>

                        <div class="form-group m-3">
                            <label for="productCategory">Product Category</label>
                            <input type="text" class="form-control" th:field="*{category}" id="productCategory" placeholder="Select Product" readonly>
                        </div>

                        <div class="form-group m-3">
                            <label for="quantity">Quantity</label>
                            <input type="number" class="form-control" th:field="*{quantity}" id="quantity" placeholder="Enter Product Quantity" required>
                        </div>

                        <div class="form-group m-3">
                            <label for="date">Purchase Date</label>
                            <input type="date" class="form-control" th:field="*{purchaseDate}" id="date" placeholder="Select Purchase Date" required>
                        </div>

                        <div class="form-group m-3">
                            <label for="seller">Seller</label>
                            <input type="text" class="form-control" th:field="*{seller}" id="seller" placeholder="Enter Seller">
                        </div>

                        <div class="form-group m-3">
                            <label for="purchaseAmount">Purchase Amount</label>
                            <input type="number" class="form-control" th:field="*{purchaseAmount}" id="purchaseAmount" placeholder="Enter Purchase Amount" required>
                        </div>

<!--                        <div class="form-group m-3">-->
<!--                            <label for="purchasePrice">Purchase Price</label>-->
<!--                            <input type="number" class="form-control" th:field="*{purchasePrice}" id="purchasePrice" placeholder="Enter Purchase Price">-->
<!--                        </div>-->

                        <button type="submit" class="btn btn-primary m-3">Add Purchase</button>

                    </form>
                </div>

            </div>

        </div>

    </div>

    <script>
        function selectProduct(element, id, name, category) {
            document.getElementById('productId').value = id;
            document.getElementById('productName').value = name;
            document.getElementById('productCategory').value = category;
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
</html>